{{/* categories.html —— 保留主题样式，只自定义顺序；不使用 set */}}

{{- $tax := site.Taxonomies.categories -}}
{{- $order := site.Params.categories.order | default (slice) -}}
{{- $items := slice -}}

{{- if gt (len $order) 0 -}}
  {{- $picked := dict -}}                   {{/* 记录已添加的 slug，避免重复 */}}
  {{- range $slug := $order -}}
    {{- if not (isset $picked $slug) -}}    {{/* isset 检查 map 是否已有该键 */}}
      {{- with index $tax $slug -}}         {{/* 取到对应的 term */}}
        {{- $items = $items | append . -}}  {{/* 追加 term */}}
        {{- $picked = merge $picked (dict $slug true) -}}  {{/* 等价 set：标记已选 */}}
      {{- end -}}
    {{- end -}}
  {{- end -}}
{{- else -}}
  {{- range $name, $term := $tax -}}
    {{- $items = $items | append $term -}}
  {{- end -}}
  {{- $items = sort $items "Page.Title" -}}
{{- end -}}

{{- if gt (len $items) 0 -}}
<nav class="categories">
  <ul>
    {{- range $items -}}
      <li><a href="{{ .Page.RelPermalink }}">{{ .Page.Title }}</a></li>
    {{- end -}}
  </ul>
</nav>
{{- end -}}
